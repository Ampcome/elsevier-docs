<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 550" font-family="Arial, sans-serif">
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <marker id="arrGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>
    <marker id="arrRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
    <marker id="arrOrange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f97316"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="425" y="35" font-size="22" font-weight="bold" fill="#1e293b" text-anchor="middle">RPC Item Status State Machine</text>
  <text x="425" y="55" font-size="12" fill="#64748b" text-anchor="middle">Valid status transitions for permission items</text>

  <!-- NEW Status -->
  <rect x="350" y="90" width="150" height="50" rx="25" fill="#e0e7ff" stroke="#6366f1" stroke-width="3" filter="url(#shadow)"/>
  <text x="425" y="120" font-size="14" font-weight="bold" fill="#4338ca" text-anchor="middle">NEW</text>

  <!-- ASSIGNED Status -->
  <rect x="350" y="180" width="150" height="50" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2" filter="url(#shadow)"/>
  <text x="425" y="210" font-size="13" font-weight="bold" fill="#1d4ed8" text-anchor="middle">ASSIGNED</text>

  <!-- IN PROGRESS Status -->
  <rect x="350" y="270" width="150" height="50" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <text x="425" y="300" font-size="13" font-weight="bold" fill="#d97706" text-anchor="middle">IN PROGRESS</text>

  <!-- PENDING RESPONSE Status -->
  <rect x="550" y="270" width="150" height="50" rx="8" fill="#fed7aa" stroke="#f97316" stroke-width="2" filter="url(#shadow)"/>
  <text x="625" y="295" font-size="12" font-weight="bold" fill="#c2410c" text-anchor="middle">PENDING</text>
  <text x="625" y="310" font-size="12" font-weight="bold" fill="#c2410c" text-anchor="middle">RESPONSE</text>

  <!-- ESCALATED Status -->
  <rect x="150" y="270" width="150" height="50" rx="8" fill="#fecaca" stroke="#ef4444" stroke-width="2" filter="url(#shadow)"/>
  <text x="225" y="300" font-size="13" font-weight="bold" fill="#dc2626" text-anchor="middle">ESCALATED</text>

  <!-- RESOLVED Status -->
  <rect x="350" y="380" width="150" height="50" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2" filter="url(#shadow)"/>
  <text x="425" y="410" font-size="13" font-weight="bold" fill="#059669" text-anchor="middle">RESOLVED</text>

  <!-- Terminal States -->
  <!-- GRANTED -->
  <rect x="200" y="480" width="120" height="45" rx="8" fill="#22c55e" filter="url(#shadow)"/>
  <text x="260" y="508" font-size="13" font-weight="bold" fill="white" text-anchor="middle">GRANTED</text>

  <!-- DENIED -->
  <rect x="365" y="480" width="120" height="45" rx="8" fill="#ef4444" filter="url(#shadow)"/>
  <text x="425" y="508" font-size="13" font-weight="bold" fill="white" text-anchor="middle">DENIED</text>

  <!-- NOT NEEDED -->
  <rect x="530" y="480" width="120" height="45" rx="8" fill="#8b5cf6" filter="url(#shadow)"/>
  <text x="590" y="503" font-size="12" font-weight="bold" fill="white" text-anchor="middle">NOT</text>
  <text x="590" y="518" font-size="12" font-weight="bold" fill="white" text-anchor="middle">NEEDED</text>

  <!-- Transitions -->
  <!-- NEW to ASSIGNED -->
  <line x1="425" y1="140" x2="425" y2="180" stroke="#64748b" stroke-width="2" marker-end="url(#arr)"/>
  <text x="435" y="165" font-size="9" fill="#64748b">Assign</text>

  <!-- ASSIGNED to IN PROGRESS -->
  <line x1="425" y1="230" x2="425" y2="270" stroke="#64748b" stroke-width="2" marker-end="url(#arr)"/>
  <text x="435" y="255" font-size="9" fill="#64748b">Start work</text>

  <!-- IN PROGRESS to PENDING RESPONSE -->
  <line x1="500" y1="295" x2="550" y2="295" stroke="#f97316" stroke-width="2" marker-end="url(#arrOrange)"/>
  <text x="525" y="285" font-size="9" fill="#f97316">Request sent</text>

  <!-- PENDING RESPONSE back to IN PROGRESS -->
  <path d="M 550 305 Q 525 340 500 305" fill="none" stroke="#64748b" stroke-width="2" marker-end="url(#arr)"/>
  <text x="510" y="350" font-size="9" fill="#64748b">Response received</text>

  <!-- IN PROGRESS to ESCALATED -->
  <line x1="350" y1="295" x2="300" y2="295" stroke="#ef4444" stroke-width="2" marker-end="url(#arrRed)"/>
  <text x="325" y="285" font-size="9" fill="#ef4444">Escalate</text>

  <!-- ESCALATED back to IN PROGRESS -->
  <path d="M 300 305 Q 325 340 350 305" fill="none" stroke="#64748b" stroke-width="2" marker-end="url(#arr)"/>
  <text x="295" y="350" font-size="9" fill="#64748b">Resolved</text>

  <!-- IN PROGRESS to RESOLVED -->
  <line x1="425" y1="320" x2="425" y2="380" stroke="#22c55e" stroke-width="2" marker-end="url(#arrGreen)"/>
  <text x="435" y="355" font-size="9" fill="#22c55e">Complete</text>

  <!-- PENDING to RESOLVED -->
  <path d="M 625 320 L 625 405 L 500 405" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrGreen)"/>
  <text x="630" y="365" font-size="9" fill="#22c55e">Complete</text>

  <!-- ESCALATED to RESOLVED -->
  <path d="M 225 320 L 225 405 L 350 405" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrGreen)"/>
  <text x="210" y="365" font-size="9" fill="#22c55e">Complete</text>

  <!-- RESOLVED to GRANTED -->
  <line x1="380" y1="430" x2="320" y2="480" stroke="#22c55e" stroke-width="2" marker-end="url(#arrGreen)"/>
  <text x="330" y="455" font-size="9" fill="#22c55e">Approved</text>

  <!-- RESOLVED to DENIED -->
  <line x1="425" y1="430" x2="425" y2="480" stroke="#ef4444" stroke-width="2" marker-end="url(#arrRed)"/>
  <text x="435" y="460" font-size="9" fill="#ef4444">Refused</text>

  <!-- RESOLVED to NOT NEEDED -->
  <line x1="470" y1="430" x2="530" y2="480" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arr)"/>
  <text x="515" y="455" font-size="9" fill="#8b5cf6">Tier 0</text>

  <!-- Direct to NOT NEEDED (from ASSIGNED for Tier 0) -->
  <path d="M 500 195 Q 700 195 700 440 Q 700 502 650 502" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arr)"/>
  <text x="715" y="330" font-size="9" fill="#8b5cf6">Tier 0</text>
  <text x="715" y="342" font-size="9" fill="#8b5cf6">(skip)</text>

  <!-- Legend -->
  <rect x="30" y="90" width="180" height="170" rx="8" fill="#f8fafc" stroke="#e2e8f0"/>
  <text x="120" y="115" font-size="12" font-weight="bold" fill="#1e293b" text-anchor="middle">Status Types</text>

  <circle cx="50" cy="140" r="8" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="65" y="144" font-size="10" fill="#64748b">Initial State</text>

  <rect x="42" y="158" width="16" height="16" rx="3" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
  <text x="65" y="170" font-size="10" fill="#64748b">Active State</text>

  <rect x="42" y="182" width="16" height="16" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <text x="65" y="194" font-size="10" fill="#64748b">Working State</text>

  <rect x="42" y="206" width="16" height="16" rx="3" fill="#22c55e"/>
  <text x="65" y="218" font-size="10" fill="#64748b">Terminal: Success</text>

  <rect x="42" y="230" width="16" height="16" rx="3" fill="#ef4444"/>
  <text x="65" y="242" font-size="10" fill="#64748b">Terminal: Denied</text>

  <!-- Notes -->
  <rect x="680" y="90" width="150" height="100" rx="6" fill="#fffbeb" stroke="#fbbf24"/>
  <text x="755" y="110" font-size="10" font-weight="bold" fill="#92400e" text-anchor="middle">Key Rules</text>
  <text x="690" y="130" font-size="9" fill="#78716c">- One active status</text>
  <text x="690" y="145" font-size="9" fill="#78716c">- Log all transitions</text>
  <text x="690" y="160" font-size="9" fill="#78716c">- Terminal = closed</text>
  <text x="690" y="175" font-size="9" fill="#78716c">- Can't reopen closed</text>
</svg>
