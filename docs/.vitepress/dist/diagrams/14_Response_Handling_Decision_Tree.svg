<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 650" font-family="Arial, sans-serif">
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="475" y="35" font-size="22" font-weight="bold" fill="#1e293b" text-anchor="middle">Response Handling Decision Tree</text>
  <text x="475" y="55" font-size="12" fill="#64748b" text-anchor="middle">How to process different types of responses from rights holders</text>

  <!-- Start: Response Received -->
  <rect x="400" y="80" width="150" height="45" rx="22" fill="#3b82f6" filter="url(#shadow)"/>
  <text x="475" y="108" font-size="12" font-weight="bold" fill="white" text-anchor="middle">Response Received</text>

  <!-- Main Decision: Response Type -->
  <polygon points="475,165 575,215 475,265 375,215" fill="white" stroke="#6366f1" stroke-width="2" filter="url(#shadow)"/>
  <text x="475" y="210" font-size="11" font-weight="bold" fill="#1e293b" text-anchor="middle">Response</text>
  <text x="475" y="225" font-size="11" font-weight="bold" fill="#1e293b" text-anchor="middle">Type?</text>

  <!-- Branch: GRANTED -->
  <rect x="80" y="280" width="130" height="50" rx="8" fill="#22c55e" filter="url(#shadow)"/>
  <text x="145" y="302" font-size="13" font-weight="bold" fill="white" text-anchor="middle">GRANTED</text>
  <text x="145" y="318" font-size="10" fill="white" text-anchor="middle">Permission approved</text>

  <!-- Branch: DENIED -->
  <rect x="280" y="280" width="130" height="50" rx="8" fill="#ef4444" filter="url(#shadow)"/>
  <text x="345" y="302" font-size="13" font-weight="bold" fill="white" text-anchor="middle">DENIED</text>
  <text x="345" y="318" font-size="10" fill="white" text-anchor="middle">Permission refused</text>

  <!-- Branch: CONDITIONAL -->
  <rect x="490" y="280" width="130" height="50" rx="8" fill="#f97316" filter="url(#shadow)"/>
  <text x="555" y="302" font-size="12" font-weight="bold" fill="white" text-anchor="middle">CONDITIONAL</text>
  <text x="555" y="318" font-size="10" fill="white" text-anchor="middle">Terms/fees required</text>

  <!-- Branch: REDIRECT -->
  <rect x="700" y="280" width="130" height="50" rx="8" fill="#8b5cf6" filter="url(#shadow)"/>
  <text x="765" y="302" font-size="13" font-weight="bold" fill="white" text-anchor="middle">REDIRECT</text>
  <text x="765" y="318" font-size="10" fill="white" text-anchor="middle">Wrong contact</text>

  <!-- GRANTED Actions -->
  <rect x="50" y="370" width="180" height="120" rx="8" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
  <text x="140" y="395" font-size="11" font-weight="bold" fill="#166534" text-anchor="middle">Actions:</text>
  <text x="60" y="418" font-size="9" fill="#166534">1. Document terms in RPC</text>
  <text x="60" y="436" font-size="9" fill="#166534">2. Record credit line format</text>
  <text x="60" y="454" font-size="9" fill="#166534">3. Process any fees</text>
  <text x="60" y="472" font-size="9" fill="#166534">4. Update status: GRANTED</text>

  <!-- DENIED Actions -->
  <rect x="250" y="370" width="190" height="150" rx="8" fill="#fecaca" stroke="#ef4444" stroke-width="2"/>
  <text x="345" y="395" font-size="11" font-weight="bold" fill="#dc2626" text-anchor="middle">Actions:</text>
  <text x="260" y="418" font-size="9" fill="#dc2626">1. Document reason for denial</text>
  <text x="260" y="436" font-size="9" fill="#dc2626">2. Notify editorial immediately</text>
  <text x="260" y="454" font-size="9" fill="#dc2626">3. Check if negotiation possible</text>
  <text x="260" y="472" font-size="9" fill="#dc2626">4. Research alternatives</text>
  <text x="260" y="490" font-size="9" fill="#dc2626">5. Update status: DENIED</text>
  <text x="260" y="508" font-size="9" fill="#dc2626">6. Suggest content removal</text>

  <!-- CONDITIONAL Sub-decision -->
  <polygon points="555,370 615,405 555,440 495,405" fill="white" stroke="#f97316" stroke-width="2" filter="url(#shadow)"/>
  <text x="555" y="400" font-size="9" font-weight="bold" fill="#1e293b" text-anchor="middle">Terms</text>
  <text x="555" y="413" font-size="9" font-weight="bold" fill="#1e293b" text-anchor="middle">Acceptable?</text>

  <!-- Conditional: Accept -->
  <rect x="460" y="470" width="100" height="70" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="510" y="495" font-size="10" font-weight="bold" fill="#d97706" text-anchor="middle">ACCEPT</text>
  <text x="510" y="515" font-size="8" fill="#92400e" text-anchor="middle">Process as</text>
  <text x="510" y="528" font-size="8" fill="#92400e" text-anchor="middle">GRANTED</text>

  <!-- Conditional: Negotiate -->
  <rect x="580" y="470" width="100" height="70" rx="6" fill="#fed7aa" stroke="#f97316" stroke-width="2"/>
  <text x="630" y="495" font-size="10" font-weight="bold" fill="#ea580c" text-anchor="middle">NEGOTIATE</text>
  <text x="630" y="515" font-size="8" fill="#9a3412" text-anchor="middle">Counter-offer</text>
  <text x="630" y="528" font-size="8" fill="#9a3412" text-anchor="middle">or escalate</text>

  <!-- Conditional: Decline -->
  <rect x="700" y="470" width="100" height="70" rx="6" fill="#fecaca" stroke="#ef4444" stroke-width="2"/>
  <text x="750" y="495" font-size="10" font-weight="bold" fill="#dc2626" text-anchor="middle">DECLINE</text>
  <text x="750" y="515" font-size="8" fill="#b91c1c" text-anchor="middle">Process as</text>
  <text x="750" y="528" font-size="8" fill="#b91c1c" text-anchor="middle">DENIED</text>

  <!-- REDIRECT Actions -->
  <rect x="680" y="370" width="170" height="90" rx="8" fill="#f3e8ff" stroke="#8b5cf6" stroke-width="2"/>
  <text x="765" y="395" font-size="11" font-weight="bold" fill="#7c3aed" text-anchor="middle">Actions:</text>
  <text x="690" y="418" font-size="9" fill="#7c3aed">1. Note new contact info</text>
  <text x="690" y="436" font-size="9" fill="#7c3aed">2. Send new request</text>
  <text x="690" y="454" font-size="9" fill="#7c3aed">3. Update RPC with notes</text>

  <!-- Final Outcomes -->
  <rect x="80" y="560" width="120" height="45" rx="8" fill="#166534" filter="url(#shadow)"/>
  <text x="140" y="588" font-size="11" font-weight="bold" fill="white" text-anchor="middle">CLOSE ITEM</text>

  <rect x="760" y="560" width="120" height="45" rx="8" fill="#4338ca" filter="url(#shadow)"/>
  <text x="820" y="583" font-size="10" font-weight="bold" fill="white" text-anchor="middle">RESTART</text>
  <text x="820" y="598" font-size="9" fill="white" text-anchor="middle">PROCESS</text>

  <!-- Arrows -->
  <!-- Start to Decision -->
  <line x1="475" y1="125" x2="475" y2="165" stroke="#64748b" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Decision to Branches -->
  <line x1="375" y1="215" x2="145" y2="215" stroke="#22c55e" stroke-width="2"/>
  <line x1="145" y1="215" x2="145" y2="280" stroke="#22c55e" stroke-width="2" marker-end="url(#arr)"/>
  <text x="260" y="205" font-size="10" fill="#22c55e" font-weight="bold">Granted</text>

  <line x1="425" y1="240" x2="345" y2="280" stroke="#ef4444" stroke-width="2" marker-end="url(#arr)"/>
  <text x="370" y="255" font-size="10" fill="#ef4444" font-weight="bold">Denied</text>

  <line x1="525" y1="240" x2="555" y2="280" stroke="#f97316" stroke-width="2" marker-end="url(#arr)"/>
  <text x="560" y="255" font-size="10" fill="#f97316" font-weight="bold">Conditional</text>

  <line x1="575" y1="215" x2="765" y2="215" stroke="#8b5cf6" stroke-width="2"/>
  <line x1="765" y1="215" x2="765" y2="280" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arr)"/>
  <text x="670" y="205" font-size="10" fill="#8b5cf6" font-weight="bold">Redirect</text>

  <!-- Granted to Close -->
  <line x1="140" y1="490" x2="140" y2="560" stroke="#166534" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Denied to Close -->
  <line x1="345" y1="520" x2="345" y2="582" stroke="#dc2626" stroke-width="2"/>
  <line x1="345" y1="582" x2="200" y2="582" stroke="#dc2626" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Conditional to Sub-decision -->
  <line x1="555" y1="330" x2="555" y2="370" stroke="#64748b" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Sub-decision branches -->
  <line x1="520" y1="420" x2="510" y2="470" stroke="#22c55e" stroke-width="2" marker-end="url(#arr)"/>
  <text x="500" y="448" font-size="9" fill="#22c55e">Yes</text>

  <line x1="555" y1="440" x2="630" y2="470" stroke="#f97316" stroke-width="2" marker-end="url(#arr)"/>
  <text x="600" y="448" font-size="9" fill="#f97316">Maybe</text>

  <line x1="590" y1="420" x2="750" y2="470" stroke="#ef4444" stroke-width="2" marker-end="url(#arr)"/>
  <text x="680" y="448" font-size="9" fill="#ef4444">No</text>

  <!-- Accept to Close -->
  <line x1="510" y1="540" x2="510" y2="582" stroke="#166534" stroke-width="2"/>
  <line x1="510" y1="582" x2="200" y2="582" stroke="#166534" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Decline to Close -->
  <line x1="750" y1="540" x2="750" y2="582" stroke="#dc2626" stroke-width="2"/>
  <line x1="750" y1="582" x2="200" y2="582" stroke="#dc2626" stroke-width="2"/>

  <!-- Redirect to Restart -->
  <line x1="765" y1="460" x2="820" y2="560" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Negotiate loop back -->
  <path d="M 630 540 L 630 590 L 900 590 L 900 100 L 550 100 L 475 125" fill="none" stroke="#f97316" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arr)"/>
  <text x="780" y="580" font-size="9" fill="#f97316">New response</text>
</svg>
